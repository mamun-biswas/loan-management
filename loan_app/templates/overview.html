{% extends 'base.html' %}

{% block content %}
<div class="page-header">
    <h1><i class="fas fa-chart-line me-2"></i>Dashboard Overview</h1>
    <p>Monitor all loan activities and financial summaries</p>
</div>

<div class="row g-4 mb-5">
    <!-- Total Loan Amount -->
    <div class="col-md-3">
        <div class="stat-card primary">
            <div class="stat-icon">
                <i class="fas fa-hand-holding-usd"></i>
            </div>
            <div class="stat-number">${{ total_loan_amount|floatformat:2 }}</div>
            <div class="stat-label">Total Loan Amount</div>
        </div>
    </div>

    <!-- Total Paid Amount -->
    <div class="col-md-3">
        <div class="stat-card success">
            <div class="stat-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-number">${{ total_paid_amount|floatformat:2 }}</div>
            <div class="stat-label">Total Paid Amount</div>
        </div>
    </div>

    <!-- Total Remaining Amount -->
    <div class="col-md-3">
        <div class="stat-card warning">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-number">${{ total_remaining_amount|floatformat:2 }}</div>
            <div class="stat-label">Total Remaining Amount</div>
        </div>
    </div>

    <!-- Total Loan Profiles -->
    <div class="col-md-3">
        <div class="stat-card info">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-number">{{ loan_count }}</div>
            <div class="stat-label">Total Loan Profiles</div>
        </div>
    </div>
</div>

<!-- Quick Stats Row -->
<div class="row g-4 mb-5">
    <div class="col-md-8">
        <div class="modern-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-chart-pie me-2"></i>Loan Distribution</h5>
                <span class="badge bg-primary badge-modern">Live Data</span>
            </div>
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="mb-4">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Paid Amount</span>
                                <span class="fw-bold">${{ total_paid_amount|floatformat:2 }}</span>
                            </div>
                            <div class="progress progress-modern">
                                {% widthratio total_paid_amount total_loan_amount 100 as paid_percent %}
                                <div class="progress-bar bg-success" role="progressbar" style="width: {{ paid_percent }}%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Remaining Amount</span>
                                <span class="fw-bold">${{ total_remaining_amount|floatformat:2 }}</span>
                            </div>
                            <div class="progress progress-modern">
                                {% widthratio total_remaining_amount total_loan_amount 100 as remaining_percent %}
                                <div class="progress-bar bg-warning" role="progressbar" style="width: {{ remaining_percent }}%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 text-center">
                        <div class="display-1 fw-bold text-primary">
                            {% widthratio total_paid_amount total_loan_amount 100 as paid_percent_int %}
                            {{ paid_percent_int }}%
                        </div>
                        <p class="text-muted">Payment Completion Rate</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="modern-card h-100">
            <div class="card-header">
                <h5><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
            </div>
            <div class="card-body d-flex flex-column">
                <a href="{% url 'create_loan' %}" class="action-btn mb-3">
                    <i class="fas fa-user-plus"></i>
                    <h6>Create New Loan</h6>
                    <small class="text-muted">Add a new borrower profile</small>
                </a>
                <a href="{% url 'make_payment' %}" class="action-btn mb-3">
                    <i class="fas fa-credit-card"></i>
                    <h6>Record Payment</h6>
                    <small class="text-muted">Accept loan repayment</small>
                </a>
                <a href="{% url 'loan_history' %}" class="action-btn">
                    <i class="fas fa-history"></i>
                    <h6>View History</h6>
                    <small class="text-muted">Check all transactions</small>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="row g-4">
    <div class="col-md-12">
        <div class="modern-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-calendar-alt me-2"></i>System Summary</h5>
                <span class="text-muted">Updated in real-time</span>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3 mb-4">
                        <div class="p-3">
                            <div class="display-5 fw-bold text-primary">{{ loan_count }}</div>
                            <div class="text-muted">Active Profiles</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="p-3">
                            <div class="display-5 fw-bold text-success">${{ total_paid_amount|floatformat:2 }}</div>
                            <div class="text-muted">Collected Amount</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="p-3">
                            <div class="display-5 fw-bold text-warning">${{ total_remaining_amount|floatformat:2 }}</div>
                            <div class="text-muted">Pending Collection</div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="p-3">
                            <div class="display-5 fw-bold text-info">{{ total_paid_amount|floatformat:0 }}</div>
                            <div class="text-muted">Total Transactions</div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-4">
                    <div class="alert alert-info alert-modern">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>System Status:</strong> All systems operational. Last updated: {{ now|date:"F j, Y, g:i a" }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}